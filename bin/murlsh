#!/usr/bin/env ruby

require 'fileutils'

require 'murlsh'

def usage
  puts <<-eos
Initialize a murlsh site instance in a web directory.

usage: murlsh DESTINATION_DIRECTORY

eos
end

if ARGV.empty?; usage; exit 1; end

dest_dir = ARGV[0]

Murlsh.cp_r_safe(
  %w{.htaccess config.ru config.yaml plugins/ public/ Rakefile}.map { |x| 
    File.join(File.dirname(__FILE__), '..', x) }, dest_dir, :verbose => true)

FileUtils.mkdir_p('tmp', :verbose => true)

cd_command = File.expand_path(dest_dir) == Dir.pwd ? '' : "cd #{dest_dir}\n"

puts <<eos
Next steps:

#{cd_command}edit config.yaml
rake init
eos
